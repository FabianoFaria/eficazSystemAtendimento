<?php	error_reporting(E_ERROR);	session_start();
	function converteImagemProduto($nomeImagemOriginal){		global $caminhoFisico;		$arquivo['large'] 		= geraImagemSistema($nomeImagemOriginal, 1024,1);		$arquivo['media'] 		= geraImagemSistema($nomeImagemOriginal, 300,2);		$arquivo['miniatura'] 	= geraImagemSistema($nomeImagemOriginal, 150,3);		unlink("$caminhoFisico/uploads/$nomeImagemOriginal");		return $arquivo;	}
	function geraImagemSistema($nomeImagem, $tamanho, $tipo){		global $caminhoFisico;		if(substr($nomeImagem, -3) == "jpg"){			$i = imagecreatefromjpeg("$caminhoFisico/uploads/$nomeImagem");			$width 		= imagesx($i);			$height 	= imagesy($i);			$thumbW = $tamanho;			$thumbH = $tamanho;			if($width >=$height) $porcentoAplicado = $thumbW / $width; else $porcentoAplicado = $thumbH / $height;			$new_width	= $width*$porcentoAplicado;			$new_height = $height*$porcentoAplicado;			$new_width	= (int) $new_width;			$new_height = (int) $new_height;			$nomeImagem =  str_replace('.jpg', '',$nomeImagem)."-".$new_width."x".$new_height.".jpg";			$image_resized = imagecreatetruecolor($new_width, $new_height);			imagecopyresampled($image_resized, $i, 0, 0, 0, 0, $new_width, $new_height, $width, $height);			imagejpeg($image_resized,"$caminhoFisico/uploads/$nomeImagem",$thumbW);			imagedestroy($image_resized);		}		if(substr($nomeImagem, -3) == "png"){			$i = imagecreatefrompng("$caminhoFisico/uploads/$nomeImagem");			$width 		= imagesx($i);			$height 	= imagesy($i);			$thumbW = $tamanho;			$thumbH = $tamanho;			if($width >=$height) $porcentoAplicado = $thumbW / $width; else $porcentoAplicado = $thumbH / $height;			$new_width	= $width*$porcentoAplicado;			$new_height = $height*$porcentoAplicado;			$new_width	= (int) $new_width;			$new_height = (int) $new_height;			$nomeImagem =  str_replace('.png', '',$nomeImagem)."-".$new_width."x".$new_height.".png";			$image_resized = imagecreatetruecolor($new_width, $new_height);			imagecopyresampled($image_resized, $i, 0, 0, 0, 0, $new_width, $new_height, $width, $height);			imagepng($image_resized,"$caminhoFisico/uploads/$nomeImagem",$thumbW);			imagedestroy($image_resized);		}		return $nomeImagem;	}?>