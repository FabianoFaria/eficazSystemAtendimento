/********* Inicio Funções TAREFAS ***********/$(document).ready(function(){	/* TELA DE LOCALIZACAO INCLUSAO E EDICAO DAS TAREFAS QUE PODEM COMPOR UM PROJETO*/	if ($("#slug-pagina").val()=="projetos-tarefas"){		$("#titulo").focus();		$(".btn-salvar-tarefa").live('click', function () {			if(validarCamposGenerico('.required')){				if ($("#tarefa-id").val()=="")					$('#tipo-acao').val("I");				else					$('#tipo-acao').val("U");				$("#frmDefault").attr('action',caminhoScript+'/modulos/projetos/projetos-tarefa-salvar.php').submit();			}		});		$(".btn-editar-tarefa").live('click', function () {			$(".incluir-nova-tarefa").hide();			$(".bloco-incluir-editar-tarefa").show();			tarefaID = $(this).attr("tarefa-id");			$("#tarefa-id").val(tarefaID);			$("#titulo").val($("#titulo-"+tarefaID).html());			$("#tempo-execucao").val($("#tempo-execucao-"+tarefaID).html());			tinyMCE.get("descricao").setContent($("#descricao-"+tarefaID).val());			$("#grupo-id").val("").trigger('chosen:updated');			$(".grupo-aux-"+tarefaID).each(function(i){				grupoID = $(this).val();				$("#grupo-id option[value='"+grupoID+"']").attr('selected',true);			});			$("#grupo-id").trigger('chosen:updated');			$("#cor-texto").val($("#cor-texto-"+tarefaID).val()).click();			setTimeout(function(){$('#modcoder_ok').click();}, 50);			$("#cor-fundo").val($("#cor-fundo-"+tarefaID).val()).click();			setTimeout(function(){$('#modcoder_ok').click();}, 50);		});		$(".btn-excluir-tarefa").live('click', function () {			if(confirm("Confirma o envio para lixeira da tarefa?")){				$("#tarefa-id").val($(this).attr("tarefa-id"));				$('#tipo-acao').val("D");				$("#frmDefault").submit();			}		});		$(".btn-cancelar-edicao-tarefa").live('click', function () {			$(".incluir-nova-tarefa").show();			$(".bloco-incluir-editar-tarefa").hide();		});		$(".incluir-nova-tarefa").live('click', function () {			$(".incluir-nova-tarefa").hide();			$(".bloco-incluir-editar-tarefa").show();			$("#tarefa-id").val("");			$("#titulo").val("");			$("#tempo-execucao").val("");			tinyMCE.get("descricao").setContent("");			$("#grupo-id").val("").trigger('chosen:updated');		});	}	/* TELA DE LOCALIZACAO DOS PROJETOS */	if ($("#slug-pagina").val()=="projetos-projeto-localizar"){		$("#botao-pesquisar-projetos").live('click', function () {			$("#frmDefault").submit();		});		$(".projeto-localizar").live('click', function () {			$("#projeto-id").val($(this).attr('projeto-id'));			$("#frmDefault").attr("action",caminhoScript+"/projetos/projetos-projeto");			$("#frmDefault").submit();		});		$(document).keypress(function(event) {if(event.keyCode==13){ $("#botao-pesquisar-projetos").click(); }});	}	/* TELA DE INCLUSAO E EDICAO DOS PROJETOS */	if ($("#slug-pagina").val()=="projetos-projeto"){		$("#titulo").focus();		$("#salvar-projeto").live('click', function () {			if (validarCamposGenerico('.required-p')){				if ($("#projeto-id").val()=="")					$("#acao").val("PI");				else					$("#acao").val("PU");				$("#frmDefault").submit();			}		});		$("#desativar-projeto").live('click', function () {			if(confirm("Confirma a desativação do projeto?")){				$("#acao").val("PD");				$("#frmDefault").submit();			}		});		$("#excluir-projeto").live('click', function () {			if(confirm("Confirma a exclusão em definitivo do projeto?")){				$("#acao").val("PDD");				$("#frmDefault").submit();			}		});		$("#reativar-projeto").live('click', function () {			$("#acao").val("PR");			$("#frmDefault").submit();		});		$(".projeto-localizar").live('click', function () {			$("#projeto-id").val($(this).attr('projeto-id'));			$("#frmDefault").attr("action",caminhoScript+"/projetos/projetos-projeto");			$("#frmDefault").submit();		});		$(".exibir-tarefa-projeto").live('click', function () {			$(".salvar-tarefa-projeto").val('Incluir');			$(".exibir-tarefa-projeto").hide();			$(".btn-editar-tarefa-projeto").hide();			$(".btn-excluir-tarefa-projeto").hide();			$("#incluir-editar-tarefa-projeto").show();		});		$("#seleciona-tarefa-id").live('change', function () {			tarefaID = $(this).val();			$("#tempo-execucao").val($("#seleciona-tarefa-id option:selected").attr("tempo-execucao"));			$.ajax({type: "POST",url: caminhoScript+"/modulos/projetos/projetos-tarefa-carregar-dados.php?tarefa-id="+tarefaID, data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",				success: function(retorno){					$(".div-detalhes-tarefas").html("<fieldset style='widht:100%;'><legend>Descri&ccedil;&atilde;o Detalhada</legend>"+retorno+"</fieldset>");				}			});		});		$(".salvar-tarefa-projeto").live('click', function () {			if (validarCamposGenerico('.required')){				if ($("#projeto-tarefa-id").val()==""){					$("#acao").val("TI");				}				else{					$("#acao").val("TU");				}				$("#frmDefault").attr("action",caminhoScript+"/projetos/projetos-projeto");				$("#frmDefault").submit();			}		});		$(".cancelar-tarefa-projeto").live('click', function () {			$("#projeto-tarefa-id").val("");			$(".exibir-tarefa-projeto").show();			$("#incluir-editar-tarefa-projeto").hide();			$(".btn-editar-tarefa-projeto").show();			$(".btn-excluir-tarefa-projeto").show();			$("#seleciona-tarefa-id").val("").trigger('chosen:updated');			$("#grupo-responsavel").val("").trigger('chosen:updated');			$("#tempo-execucao").val("");			$("#posicao-tarefa").val($("#posicao-tarefa-default").val());		});		$(".btn-editar-tarefa-projeto").live('click', function () {			$(".salvar-tarefa-projeto").val('Atualizar');			$(".exibir-tarefa-projeto").hide();			$(".btn-editar-tarefa-projeto").hide();			$(".btn-excluir-tarefa-projeto").hide();			$("#incluir-editar-tarefa-projeto").show();			i = $(this).attr("projeto-tarefa-id");			$("#projeto-tarefa-id").val(i);			$("#seleciona-tarefa-id").val($("#tarefa-id-"+i).val()).trigger('chosen:updated');			$("#grupo-responsavel").val($("#grupo-responsavel-id-"+i).val()).trigger('chosen:updated');			$("#usuario-responsavel").val($("#usuario-responsavel-id-"+i).val()).trigger('chosen:updated');			$("#tempo-execucao").val($("#tempo-execucao-"+i).val());			$("#posicao-tarefa").val($("#posicao-"+i).val());		});		$(".btn-excluir-tarefa-projeto").live('click', function () {			if(confirm("Confirma o envio para lixeira da tarefa?")){				$("#projeto-tarefa-id").val($(this).attr("projeto-tarefa-id"));				$("#acao").val("TD");				$("#frmDefault").submit();			}		});	}});
/********* Inicio Funções tarefas para o chamado ***********//*$("#select-grupo-tarefa").live('change', function () {	campo = $(this).attr('campo');	$("#div-select-usuario-tarefa").load(caminhoScript+"/modulos/chamados/chamados-localiza-usuarios-grupo.php?grupo="+$(this).val()+"&campo="+campo);});
$("#botao-adiciona-tarefa-chamado").live('click', function () {	var erro = 0;	$(".required").each(function( i ) {		$(this).css('background-color', '').css('outline', '');		if($(this).val()==""){			$(this).css('background-color', '#FFE4E4').css('outline', '1px solid #FFCDCD');			erro = 1;		}	});	if(erro==0){		$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-tarefa.php", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",			success: function(retorno){				$(".required").each(function( i ) {					$(this).val('');				});				$("#select-usuario-tarefa").val('');				$("#lista-tarefas-cadastradas").html(retorno);			},		});	}});$(".required").live('change keyup', function () {	if($(this).val() != "")$(this).css('background-color', '').css('outline', '');	$("#"+$(this).attr('id').replace('-','_').replace('-','_')+"_chosen a").css('background-color', '').css('outline', '');});$(document).ready(function(){	$("#tarefa-data-limite").click();});$("#botao-finaliza-tarefa").live('click', function () {	$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-follow-tarefa.php?finaliza=s", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",		success: function(retorno){			$(parent.document.getElementById('horas-utilizadas')).load(caminhoScript+"/modulos/chamados/chamados-horas-utilizadas-tarefa.php?wID="+parent.document.getElementById('workflow-id').value);			if(parent.document.getElementById('lista-tarefas-cadastradas'))				parent.document.getElementById('lista-tarefas-cadastradas').innerHTML = retorno;			parent.$.fancybox.close();		},	});});$("#botao-adiciona-observacao-follow").live('click', function () {	var erro = 0;	$(".required").each(function( i ) {		$(this).css('background-color', '').css('outline', '');		if($(this).val()==""){			$(this).css('background-color', '#FFE4E4').css('outline', '1px solid #FFCDCD');			if(erro==0) $(this).focus();			erro = 1;		}	});	if(erro==0){		$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-follow-tarefa.php", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",			success: function(retorno){				campoHoras = parent.document.getElementById('horas-utilizadas');				$(campoHoras).load(caminhoScript+"/modulos/chamados/chamados-horas-utilizadas-tarefa.php?wID="+parent.document.getElementById('workflow-id').value);				if(parent.document.getElementById('lista-tarefas-cadastradas')){					parent.document.getElementById('lista-tarefas-cadastradas').innerHTML = retorno;					parent.$.fancybox.close();				}else{					parent.location.reload();				}			},		});	}});$("#botao-cancela-tarefa").live('click', function () {	$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cancela-tarefa.php?wID="+parent.document.getElementById('workflow-id').value, data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",		success: function(retorno){			parent.document.getElementById('lista-tarefas-cadastradas').innerHTML = retorno;			campoHoras = parent.document.getElementById('horas-utilizadas');			$(campoHoras).load(caminhoScript+"/modulos/chamados/chamados-horas-utilizadas-tarefa.php?wID="+parent.document.getElementById('workflow-id').value);			parent.$.fancybox.close();		},	});});*//* Inicio do Relatorio de calendario*/$(".calendario-mes").live('click', function () {	data = $(this).attr('attr-mes-ano').split("|");	$("#mes-calendario").val(data[0]);	$("#ano-calendario").val(data[1]);	$("#frmDefault").submit();});$("#botao-pesquisar-calendario").live('click', function () {	$("#frmDefault").submit();});$(".link-projeto-tarefa").live('click', function () {	$("#workflow-id").val($(this).attr('workflow-id'));	if ($(this).attr('origem')=='orcamentos_workflows'){		$("#frmDefault").attr("action",caminhoScript+"/chamados/chamados-orcamento");		//$("#frmDefault").attr("action",caminhoScript+"/chamados/chamados-orcamento#menu-superior-6");	}	if ($(this).attr('origem')=='chamados_workflows'){		$("#frmDefault").attr("action",caminhoScript+"/chamados/chamados-cadastro-chamado");		//$("#frmDefault").attr("action",caminhoScript+"/chamados/chamados-cadastro-chamado#menu-superior-10");	}	if ($(this).attr('origem')=='cadastros_dados'){		$("#frmDefault").attr("action",caminhoScript+"/cadastros/cadastro-dados");		//$("#frmDefault").attr("action",caminhoScript+"/cadastros/cadastro-dados#menu-superior-9");	}	if ($(this).attr('origem')=='tele_workflows'){		$('#tipo-interacao').remove();		$("#frmDefault").prepend("<input type='text' name='tipo-interacao' id='tipo-interacao' value='direta'/>");		$("#frmDefault").attr("action",caminhoScript+"/tele/tele-operacao");		//$("#frmDefault").attr("action",caminhoScript+"/tele/tele-operacao#menu-superior-2");	}	/*	if ($(this).attr('origem')=='chamados_workflows')		$("#frmDefault").attr("action",caminhoScript+"/chamados/chamados-orcamento");	*/	$("#frmDefault").submit();});/* Final do Relatorio de calendario*//*$(".finaliza-edita-chamado, .altera-data-retorno-tarefa").live('hover', function () {	$(this).attr('src',caminhoScript+'/images/geral/ico-editar-var-produto-hover.png');});$(".finaliza-edita-chamado, .altera-data-retorno-tarefa").live('mouseout', function () {	$(this).attr('src',caminhoScript+'/images/geral/ico-editar-var-produto.png');});$(".altera-data-retorno-tarefa-confirma").live('hover', function () {	$(this).attr('src',caminhoScript+'/images/geral/ico-atualizar-var-produto-hover.png');});$(".altera-data-retorno-tarefa-confirma").live('mouseout', function () {	$(this).attr('src',caminhoScript+'/images/geral/ico-atualizar-var-produto.png');});$(".altera-data-retorno-tarefa").live('click', function () {	$("#div-data-retorno-tarefa").addClass('esconde');	$("#div-data-retorno-tarefa-edita").removeClass('esconde');	$("#campo-data-retorno-tarefa").click();});$(".altera-data-retorno-tarefa-confirma").live('click', function () {	$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/data-retorno-tarefa-altera.php", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",		success: function(retorno){			$("#div-data-retorno-tarefa-edita").addClass('esconde');			$("#div-data-retorno-tarefa").removeClass('esconde');			$("#data-final-retorno-tarefa").html(retorno);			location.reload();		}	});});$(".fancybox-overlay, .fancybox-close, .fancybox-close").live('click', function () {	$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-tarefa.php", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",		success: function(retorno){			$(".required").each(function( i ) {				$(this).val('');			});			$("#select-usuario-tarefa").val('');			$("#lista-tarefas-cadastradas").html(retorno);			campoHoras = parent.document.getElementById('horas-utilizadas');			$(campoHoras).load(caminhoScript+"/modulos/chamados/chamados-horas-utilizadas-tarefa.php?wID="+parent.document.getElementById('workflow-id').value);		},	});});*//* Inicio Relatório Tarefas*/$(document).ready(function(){	if ($("#slug-pagina").val()=="chamados-relatorio-tarefas"){		exibeBotaoGraficos();		$("#select-agrupar").live('change', function () {			exibeBotaoGraficos();		});	}});function exibeBotaoGraficos(){	if (($("#select-agrupar").val()=="chamado") || ($("#select-agrupar").val()=="solicitante")||($("#select-agrupar").val()=="responsavel"))		$(".exibe-graficos").show();	else		$(".exibe-graficos").hide();}/* Inicio Relatório Tarefas*/$("#botao-encaminha-tarefa").live('click', function () {	var erro = 0;	$("#descricao-tarefa-follow").css('background-color', '').css('outline', '');	if($("#descricao-tarefa-follow").val()==""){		$("#descricao-tarefa-follow").css('background-color', '#FFE4E4').css('outline', '1px solid #FFCDCD');		if(erro==0) $("#descricao-tarefa-follow").focus();		erro = 1;	}	if(erro==0){		$("#cadastra-observacoes-tarefa").hide();		$("#observacoes-cadastradas-tarefa").hide();		$("#container-encaminha-tarefa").show();	}});$(".required-e").live('change keyup', function () {	if($(this).val() != "")$(this).css('background-color', '').css('outline', '');});
$("#botao-encaminha-tarefa-finaliza").live('click', function () {	var erro = 0;	$(".required-e").each(function( i ) {		$(this).css('background-color', '').css('outline', '');		if($(this).val()==""){			$(this).css('background-color', '#FFE4E4').css('outline', '1px solid #FFCDCD');			if(erro==0) $(this).focus();			erro = 1;		}	});	if(erro==0){		$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-follow-tarefa.php", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",			success: function(retorno){				$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-follow-tarefa.php?finaliza=s&encaminhada=s", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",					success: function(retorno){						$.ajax({type: "POST",url: caminhoScript+"/modulos/chamados/chamados-cadastra-tarefa.php?encaminhada=s", data: $("form").serialize(), dataType: "html", contentType: "application/x-www-form-urlencoded;charset=UTF-8",							success: function(retorno){								parent.document.getElementById('lista-tarefas-cadastradas').innerHTML = retorno;								campoHoras = parent.document.getElementById('horas-utilizadas');								$(campoHoras).load(caminhoScript+"/modulos/chamados/chamados-horas-utilizadas-tarefa.php?wID="+parent.document.getElementById('workflow-id').value);								parent.$.fancybox.close();							},						});					},				});			},		});	}});$("#botao-cancela-tarefa-finaliza").live('click', function () {		$("#cadastra-observacoes-tarefa").show();		$("#observacoes-cadastradas-tarefa").show();		$("#container-encaminha-tarefa").hide();});$(".incluir-tarefa-agenda-pessoal").live('click', function () {	$.fancybox.open({		href : caminhoScript+"/modulos/projetos/projetos-tarefa.php",		type : 'iframe',		width: '90%',		padding : 2	});});